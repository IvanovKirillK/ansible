---
- name: configure dialpeer {{ dialpeer_number }}
  ios_config:
    lines: description {{ dialpeer_description }}
    when: dialpeer_description is defined
    parrents: dial-peer voice {{ dialpeer_number }} voip
  ios_config:
    lines: destination-pattern {{ destination_pattern }}
    when: destination_pattern is defined
    parrents: dial-peer voice {{ dialpeer_number }} voip
  ios_config:
    lines: incoming uri from {{ uri_from }}
    when: uri_from is defined
    parrents: dial-peer voice {{ dialpeer_number }} voip
  ios_config:
    lines: translate {{ translate_leg }} {{ translation_rule_number }}
    when: translate_leg is defined and translation_rule_number is defined
    parrents: dial-peer voice {{ dialpeer_number }} voip
  ios_config:
    lines: answer-address {{ answer_address }}
    when: answer_address is defined
    parrents: dial-peer voice {{ dialpeer_number }} voip
  ios_config:
    lines: session target {{ cucm_address }}
    when: cucm_address is defined
    parrents: dial-peer voice {{ dialpeer_number }} voip
  ios_config:
    lines: 
      - session protocol sipv2
      - dtmf-relay rtp-nte
    parrents: dial-peer voice {{ dialpeer_number }} voip
  ios_config:
    lines: voice class codec {{ codec_class_number }}
    when: codec_class_number is defined
    parrents: dial-peer voice {{ dialpeer_number }} voip
  ios_config:
    lines: session target ipv4:{{ cucm_address }}
    when: cucm_address is defined
    parrents: dial-peer voice {{ dialpeer_number }} voip